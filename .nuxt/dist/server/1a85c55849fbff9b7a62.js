exports.ids=[4],exports.modules={100:function(t,e,r){"use strict";r.r(e);var n=r(89),o=r(91),l={components:{SubNavMsg:r(92).a},head:()=>({title:"用户消息记录"}),data:()=>({listData:{list:[],page:1,limit:10,count:0,search:""},userList:"",noticeList:""}),methods:{...o.a,async getListData(){let data={};data.page=this.listData.page,data.limit=this.listData.limit,data.search=this.listData.search;try{let t=await n.a.getMessageListData(data);if(console.log("/getListData dataRet:",t),0!==t.code)throw new Error(t.message);this.listData.count=t.data.count,t.data.rows.forEach(t=>{this.listData.list.push(t)})}catch(t){this.$message.error(t.message||"获取列表数据失败")}},getRefreshData(){this.listData.list=[],this.listData.count=0,this.getListData().then(()=>{this.getUserList(),this.getNoticeList()})},pageChange(t){this.listData.list=[],this.listData.page=t,this.getListData()},async getUserList(){let t=[];this.userList=[],this.listData.list.forEach(e=>{t.push(e.user_id)});let e=await n.a.getUserListData({ids:t,limit:0});console.log("/getUserList ret:",e),0===e.code&&(this.userList=e.data.rows)},async getNoticeList(){let t=[];this.noticeList=[],this.listData.list.forEach(e=>{t.push(e.user_id)});let e=await n.a.getNoticeListData({ids:t,limit:0});console.log("/getNoticeList ret:",e),0===e.code&&(this.noticeList=e.data.rows)}},created(){this.getListData().then(()=>{this.getUserList(),this.getNoticeList()})}},c=r(2),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("sub-nav-msg"),t._ssrNode(" "),r("el-table",{attrs:{data:t.listData.list}},[r("el-table-column",{attrs:{label:"ID",prop:"id"}}),t._v(" "),r("el-table-column",{attrs:{label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.type?r("span",[t._v("用户消息")]):t._e(),t._v(" "),1==e.row.type?r("span",[t._v("公告消息")]):t._e()]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.type?r("span",[t._v(t._s(e.row.info))]):t._e(),t._v(" "),1==e.row.type&&e.row.notice_id>0?t._l(t.noticeList,(function(n){return e.row.notice_id==n.id?r("span",{key:n.id},[t._v(t._s(n.id)+"."+t._s(n.title))]):t._e()})):t._e()]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"发送时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.dateFormat(e.row.create_time))+"\n      ")]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"用户信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.user_id>0?r("div",t._l(t.userList,(function(n){return e.row.user_id==n.id?r("span",[t._v(t._s(n.id)+"."+t._s(n.username||n.mobile))]):t._e()})),0):t._e()]}}])})],1),t._ssrNode(" "),r("el-pagination",{staticClass:"mt-4",attrs:{"current-page":t.listData.page,"page-size":t.listData.limit,layout:"prev, pager, next, total, jumper",total:t.listData.count},on:{"current-change":t.pageChange,"prev-click":t.pageChange,"next-click":t.pageChange}})],2)}),[],!1,null,null,"3fd78f70");e.default=component.exports},89:function(t,e,r){"use strict";var n=r(8);e.a={getUserListData:async data=>await n.a.post("/api/user/data/list",data),getNoticeListData:async data=>await n.a.post("/api/user/notice/list",data),noticeDataCreate:async data=>await n.a.post("/api/user/notice/create",data),noticeDataUpdate:async data=>await n.a.post("/api/user/notice/update",data),noticeSendUser:async data=>await n.a.post("/api/user/notice/sendUser",data),noticeDelete:async data=>await n.a.post("/api/user/notice/delete",data),getMessageListData:async data=>await n.a.post("/api/user/message/list",data)}},91:function(t,e,r){"use strict";var n=r(87),o=r.n(n);e.a={formValidata:t=>new Promise((e,r)=>{t.validate(t=>{e(!!t)})}),unLimitTreeLevel(t,e=0){var r=[],n=function(t,e,o){for(var i=0;i<t.length;i++){var l=t[i];if(l.pid==e){l.level=o,l.html="";for(let t=0;t<o;t++)l.html+=" -- ";r.push(l),n(t,l.id,o+1)}}};return n(t,e,0),r},getTimestamp(t){let e=new Date(t);return parseInt(e.getTime()/1e3)},dateFormat(t,e){e=e||"YYYY-MM-DD HH:mm";let r=null;return r=t?new Date(1e3*t):new Date,o()(r).format(e)},dateDisplay(t){let e=parseInt(Date.now()/1e3)-t;if(e<60)return e+"秒前";if(e>=60&&e<3600)return parseInt(e/60).toString()+"分钟前";if(e>=3600&&e<86400)return parseInt(e/3600).toString()+"小时前";if(e>=86400&&e<2592e3)return parseInt(e/3600/24).toString()+"天前";{let e="YYYY-MM-DD HH:mm",r=new Date(1e3*t);return o()(r).format(e)}},monthPlus(t,e=1,r=!0){let n=[31,28,31,30,31,30,31,31,30,31,30,31],o=parseInt(this.dateFormat(t,"YYYY")),l=parseInt(this.dateFormat(t,"MM")),c=parseInt(this.dateFormat(t,"DD"));n[1]=o%4==0&&o/100!=0||o%100==0&&o%400==0?29:28;let d=0;d+=n[l-1]-c;for(let i=0;i<e;i++){(l+=1)>12&&(l=1,o+=1),n[1]=o%4==0&&o/100!=0||o%100==0&&o%400==0?29:28;let t=n[l-1];i==e-1&&(t=t-c<0?t:c),console.log("for days:",t),d+=t}return r?(t=t||parseInt(Date.now()/1e3))+24*d*3600:d}}},92:function(t,e,r){"use strict";var n={},o=r(2),component=Object(o.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-menu",{attrs:{"default-active":this.$store.state.subNavMsgIndex,mode:"horizontal"}},[e("el-menu-item",{attrs:{index:"0"}},[e("router-link",{attrs:{to:"/msg/notice"}},[this._v("公告消息")])],1),this._v(" "),e("el-menu-item",{attrs:{index:"1"}},[e("router-link",{attrs:{to:"/msg/list"}},[this._v("用户消息记录")])],1)],1)],1)}),[],!1,null,null,"1bf15d84");e.a=component.exports}};