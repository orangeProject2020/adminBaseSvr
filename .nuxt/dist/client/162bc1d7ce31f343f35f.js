(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{318:function(e,t,r){e.exports=function(e){"use strict";var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function r(e,t){var a=e[0],b=e[1],r=e[2],n=e[3];b=((b+=((r=((r+=((n=((n+=((a=((a+=(b&r|~b&n)+t[0]-680876936|0)<<7|a>>>25)+b|0)&b|~a&r)+t[1]-389564586|0)<<12|n>>>20)+a|0)&a|~n&b)+t[2]+606105819|0)<<17|r>>>15)+n|0)&n|~r&a)+t[3]-1044525330|0)<<22|b>>>10)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b&r|~b&n)+t[4]-176418897|0)<<7|a>>>25)+b|0)&b|~a&r)+t[5]+1200080426|0)<<12|n>>>20)+a|0)&a|~n&b)+t[6]-1473231341|0)<<17|r>>>15)+n|0)&n|~r&a)+t[7]-45705983|0)<<22|b>>>10)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b&r|~b&n)+t[8]+1770035416|0)<<7|a>>>25)+b|0)&b|~a&r)+t[9]-1958414417|0)<<12|n>>>20)+a|0)&a|~n&b)+t[10]-42063|0)<<17|r>>>15)+n|0)&n|~r&a)+t[11]-1990404162|0)<<22|b>>>10)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b&r|~b&n)+t[12]+1804603682|0)<<7|a>>>25)+b|0)&b|~a&r)+t[13]-40341101|0)<<12|n>>>20)+a|0)&a|~n&b)+t[14]-1502002290|0)<<17|r>>>15)+n|0)&n|~r&a)+t[15]+1236535329|0)<<22|b>>>10)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b&n|r&~n)+t[1]-165796510|0)<<5|a>>>27)+b|0)&r|b&~r)+t[6]-1069501632|0)<<9|n>>>23)+a|0)&b|a&~b)+t[11]+643717713|0)<<14|r>>>18)+n|0)&a|n&~a)+t[0]-373897302|0)<<20|b>>>12)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b&n|r&~n)+t[5]-701558691|0)<<5|a>>>27)+b|0)&r|b&~r)+t[10]+38016083|0)<<9|n>>>23)+a|0)&b|a&~b)+t[15]-660478335|0)<<14|r>>>18)+n|0)&a|n&~a)+t[4]-405537848|0)<<20|b>>>12)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b&n|r&~n)+t[9]+568446438|0)<<5|a>>>27)+b|0)&r|b&~r)+t[14]-1019803690|0)<<9|n>>>23)+a|0)&b|a&~b)+t[3]-187363961|0)<<14|r>>>18)+n|0)&a|n&~a)+t[8]+1163531501|0)<<20|b>>>12)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b&n|r&~n)+t[13]-1444681467|0)<<5|a>>>27)+b|0)&r|b&~r)+t[2]-51403784|0)<<9|n>>>23)+a|0)&b|a&~b)+t[7]+1735328473|0)<<14|r>>>18)+n|0)&a|n&~a)+t[12]-1926607734|0)<<20|b>>>12)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b^r^n)+t[5]-378558|0)<<4|a>>>28)+b|0)^b^r)+t[8]-2022574463|0)<<11|n>>>21)+a|0)^a^b)+t[11]+1839030562|0)<<16|r>>>16)+n|0)^n^a)+t[14]-35309556|0)<<23|b>>>9)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b^r^n)+t[1]-1530992060|0)<<4|a>>>28)+b|0)^b^r)+t[4]+1272893353|0)<<11|n>>>21)+a|0)^a^b)+t[7]-155497632|0)<<16|r>>>16)+n|0)^n^a)+t[10]-1094730640|0)<<23|b>>>9)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b^r^n)+t[13]+681279174|0)<<4|a>>>28)+b|0)^b^r)+t[0]-358537222|0)<<11|n>>>21)+a|0)^a^b)+t[3]-722521979|0)<<16|r>>>16)+n|0)^n^a)+t[6]+76029189|0)<<23|b>>>9)+r|0,b=((b+=((r=((r+=((n=((n+=((a=((a+=(b^r^n)+t[9]-640364487|0)<<4|a>>>28)+b|0)^b^r)+t[12]-421815835|0)<<11|n>>>21)+a|0)^a^b)+t[15]+530742520|0)<<16|r>>>16)+n|0)^n^a)+t[2]-995338651|0)<<23|b>>>9)+r|0,b=((b+=((n=((n+=(b^((a=((a+=(r^(b|~n))+t[0]-198630844|0)<<6|a>>>26)+b|0)|~r))+t[7]+1126891415|0)<<10|n>>>22)+a|0)^((r=((r+=(a^(n|~b))+t[14]-1416354905|0)<<15|r>>>17)+n|0)|~a))+t[5]-57434055|0)<<21|b>>>11)+r|0,b=((b+=((n=((n+=(b^((a=((a+=(r^(b|~n))+t[12]+1700485571|0)<<6|a>>>26)+b|0)|~r))+t[3]-1894986606|0)<<10|n>>>22)+a|0)^((r=((r+=(a^(n|~b))+t[10]-1051523|0)<<15|r>>>17)+n|0)|~a))+t[1]-2054922799|0)<<21|b>>>11)+r|0,b=((b+=((n=((n+=(b^((a=((a+=(r^(b|~n))+t[8]+1873313359|0)<<6|a>>>26)+b|0)|~r))+t[15]-30611744|0)<<10|n>>>22)+a|0)^((r=((r+=(a^(n|~b))+t[6]-1560198380|0)<<15|r>>>17)+n|0)|~a))+t[13]+1309151649|0)<<21|b>>>11)+r|0,b=((b+=((n=((n+=(b^((a=((a+=(r^(b|~n))+t[4]-145523070|0)<<6|a>>>26)+b|0)|~r))+t[11]-1120210379|0)<<10|n>>>22)+a|0)^((r=((r+=(a^(n|~b))+t[2]+718787259|0)<<15|r>>>17)+n|0)|~a))+t[9]-343485551|0)<<21|b>>>11)+r|0,e[0]=a+e[0]|0,e[1]=b+e[1]|0,e[2]=r+e[2]|0,e[3]=n+e[3]|0}function n(s){var i,e=[];for(i=0;i<64;i+=4)e[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24);return e}function o(a){var i,e=[];for(i=0;i<64;i+=4)e[i>>2]=a[i]+(a[i+1]<<8)+(a[i+2]<<16)+(a[i+3]<<24);return e}function l(s){var i,e,t,o,l,c,h=s.length,f=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=h;i+=64)r(f,n(s.substring(i-64,i)));for(e=(s=s.substring(i-64)).length,t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<e;i+=1)t[i>>2]|=s.charCodeAt(i)<<(i%4<<3);if(t[i>>2]|=128<<(i%4<<3),i>55)for(r(f,t),i=0;i<16;i+=1)t[i]=0;return o=(o=8*h).toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(o[2],16),c=parseInt(o[1],16)||0,t[14]=l,t[15]=c,r(f,t),f}function c(e){var r,s="";for(r=0;r<4;r+=1)s+=t[e>>8*r+4&15]+t[e>>8*r&15];return s}function h(e){var i;for(i=0;i<e.length;i+=1)e[i]=c(e[i]);return e.join("")}function f(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function d(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function y(){this.reset()}return h(l("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(r,n){var o,l,c,h,f=this.byteLength,d=t(r,f),y=f;return n!==e&&(y=t(n,f)),d>y?new ArrayBuffer(0):(o=y-d,l=new ArrayBuffer(o),c=new Uint8Array(l),h=new Uint8Array(this,d,o),c.set(h),l)}}(),y.prototype.append=function(e){return this.appendBinary(f(e)),this},y.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var i,t=this._buff.length;for(i=64;i<=t;i+=64)r(this._hash,n(this._buff.substring(i-64,i)));return this._buff=this._buff.substring(i-64),this},y.prototype.end=function(e){var i,t,r=this._buff,n=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<n;i+=1)o[i>>2]|=r.charCodeAt(i)<<(i%4<<3);return this._finish(o,n),t=h(this._hash),e&&(t=d(t)),this.reset(),t},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},y.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(e,t){var n,o,l,i=t;if(e[i>>2]|=128<<(i%4<<3),i>55)for(r(this._hash,e),i=0;i<16;i+=1)e[i]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(n[2],16),l=parseInt(n[1],16)||0,e[14]=o,e[15]=l,r(this._hash,e)},y.hash=function(e,t){return y.hashBinary(f(e),t)},y.hashBinary=function(content,e){var t=h(l(content));return e?d(t):t},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(e){var i,t,n,l,c,h=(t=this._buff.buffer,n=e,l=!0,(c=new Uint8Array(t.byteLength+n.byteLength)).set(new Uint8Array(t)),c.set(new Uint8Array(n),t.byteLength),l?c:c.buffer),f=h.length;for(this._length+=e.byteLength,i=64;i<=f;i+=64)r(this._hash,o(h.subarray(i-64,i)));return this._buff=i-64<f?new Uint8Array(h.buffer.slice(i-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(e){var i,t,r=this._buff,n=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<n;i+=1)o[i>>2]|=r[i]<<(i%4<<3);return this._finish(o,n),t=h(this._hash),e&&(t=d(t)),this.reset(),t},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var e,t=y.prototype.getState.call(this);return t.buff=(e=t.buff,String.fromCharCode.apply(null,new Uint8Array(e))),t},y.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e,t){var i,r=e.length,n=new ArrayBuffer(r),o=new Uint8Array(n);for(i=0;i<r;i+=1)o[i]=e.charCodeAt(i);return t?o:n}(e.buff,!0),y.prototype.setState.call(this,e)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(e,t){var n=h(function(a){var i,e,t,n,l,c,h=a.length,f=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=h;i+=64)r(f,o(a.subarray(i-64,i)));for(a=i-64<h?a.subarray(i-64):new Uint8Array(0),e=a.length,t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<e;i+=1)t[i>>2]|=a[i]<<(i%4<<3);if(t[i>>2]|=128<<(i%4<<3),i>55)for(r(f,t),i=0;i<16;i+=1)t[i]=0;return n=(n=8*h).toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(n[2],16),c=parseInt(n[1],16)||0,t[14]=l,t[15]=c,r(f,t),f}(new Uint8Array(e)));return t?d(n):n},y}()},319:function(e,t,r){"use strict";r.r(t);r(21);var n,o,l,c=r(2),h=(r(56),r(179),r(31),r(15),r(84),r(318)),f=r.n(h),d=r(67),y={data:function(){return{fileObject:{},fileMd5CheckProcess:"",fileMd5:"",fileExt:"",chunkSize:5e5,chunks:0,currentChunk:0,isUploading:!1,accpetTypeRule:this.accpetTypeLimit,accpetTypes:{"application/zip":"zip","image/jpeg":"jpg","image/png":"png","video/mp4":"mp4"},uploadStep:0,uploadError:""}},props:{accpetTypeLimit:{type:String,default:"mp4|jpg|png",required:!1}},computed:{id:function(){return"uploader_"+parseInt(1e7*Math.random())}},methods:{chooseFile:function(){this.isUploading?this.$alert("上传中。。。"):this.$refs.fileInput.click()},checkFileType:function(e){var t=e.type;if(t){if(!(Object.keys(this.accpetTypes).indexOf(t)>-1))return this.fileExt="",this.$alert("不支持的文件类型"),!1;this.fileExt=this.accpetTypes[t]}else this.fileExt=e.name.match(/\.(\w+)$/)[1];return this.accpetTypeRule.indexOf(this.fileExt)<0?(this.$alert("不支持的文件类型"),!1):(console.log("checkFileType ext:",this.fileExt),!0)},readFileMd5:function(e){console.log("readFileMd5 start .....");var t=this,r=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,n=Math.ceil(e.size/t.chunkSize);console.log("readFileMd5 chunks:",n),this.chunks=n,this.currentChunk=0,this.fileMd5="",this.uploadStep=0,this.uploadError="";var o=new f.a.ArrayBuffer,l=new FileReader;return new Promise((function(c,h){l.onload=function(e){t.fileMd5CheckProcess=t.currentChunk+1+"/"+n,console.log("readFileMd5 read chunk nr",t.currentChunk+1,"/",n);var r=e.target.result;if(o.append(r),t.currentChunk++,t.currentChunk<n)f();else{var l=o.end();console.info("readFileMd5 computed hash:",l),console.log("readFileMd5 end ....."),c(l)}},l.onerror=function(){console.log("readFileMd5 fail ....."),c(null)};var f=function(){var n=t.currentChunk*t.chunkSize,o=n+t.chunkSize>=e.size?e.size:n+t.chunkSize;l.readAsArrayBuffer(r.call(e,n,o))};f()}))},getFileUploadedInfo:(o=Object(c.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.post("/api/utils/file/getItem",{md5:t});case 2:return r=e.sent,console.log("getFileUploadedInfo ret",r),0===r.code&&r.data?this.uploadStep=r.data.step||0:this.uploadStep=0,this.uploadStep==this.chunks&&this.$emit("uploadSuccess",{md5:this.fileMd5}),console.log("getFileUploadedInfo this.uploadStep:",this.uploadStep),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)}),fileSliceAction:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(arguments.length>2&&arguments[2],File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice),n=t*this.chunkSize,o=n+this.chunkSize>=e.size?e.size:n+this.chunkSize;return r.call(e,n,o)},uploadFileSlice:(n=Object(c.a)(regeneratorRuntime.mark((function e(){var t,r,n,o,l,c,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("uploadFileSlice start ..."),t=this.uploadStep||0,r=this.fileObject,console.log("uploadFileSlice file:",r),this.isUploading=!0,e.prev=5,n={md5:this.fileMd5,size:r.size,type:r.type,ext:this.fileExt,step:t,chunks:this.chunks},o=t;case 8:if(!(o<this.chunks)){e.next=25;break}return console.log("uploadFileSlice step:",t),l=this.fileSliceAction(r,t),console.log("uploadFileSlice slice",l),n.step=o,this.uploadStep=o,e.next=16,this.uploadFileRequest(l,n);case 16:if(c=e.sent,console.log("uploadFileSlice step retUp",t,c),h=c?JSON.parse(c):{},console.log("uploadFileSlice step retUpJson",t,h),0==h.code){e.next=22;break}throw new Error(h.message||"未知错误");case 22:o++,e.next=8;break;case 25:return this.uploadStep+=1,this.isUploading=!1,this.$emit("uploadSuccess",{md5:this.fileMd5}),e.abrupt("return",!0);case 31:return e.prev=31,e.t0=e.catch(5),this.uploadError=e.t0.message||e.t0,e.abrupt("return",null);case 35:case"end":return e.stop()}}),e,this,[[5,31]])}))),function(){return n.apply(this,arguments)}),uploadFileRequest:function(e,t){return console.log("uploadFileRequest params",t),new Promise((function(r,n){var data=new FormData;data.append("file",e);var o=new XMLHttpRequest;o.addEventListener("readystatechange",(function(){4===this.readyState&&(console.log("uploadFileRequest responseText",this.responseText),r(this.responseText))}));var l="http://api.jianpiane.com";l+="/upload/slice",l+="?md5="+t.md5,l+="&size="+t.size,l+="&type="+t.type,l+="&ext="+t.ext,l+="&step="+t.step,l+="&chunks="+t.chunks,console.log("uploadFileRequest url",l),o.open("POST",l),o.send(data)}))}},created:function(){console.log("uploader created")},mounted:function(){console.log("uploader mounted");var e=this,t=function(){var t=Object(c.a)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.files[0],console.log(r),e.fileObject=r,n=e.checkFileType(r),console.log("checkFileType ret: ",n),n){t.next=7;break}return t.abrupt("return",!1);case 7:return t.prev=7,t.next=10,e.readFileMd5(r);case 10:return o=t.sent,e.fileMd5=o,t.next=14,e.getFileUploadedInfo(o);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(7),this.$alert("校验文件失败");case 19:case"end":return t.stop()}}),t,this,[[7,16]])})));return function(){return t.apply(this,arguments)}}(),r=this.id;console.log("uploaderId:",r),document.getElementById(r).addEventListener("change",t)}},v=r(16),_={components:{Uploader:Object(v.a)(y,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-button",{attrs:{type:"primary"},on:{click:e.chooseFile}},[e._v("选择文件")]),e._v(" "),r("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",name:"video",id:e.id}}),e._v(" "),r("div",{staticClass:"mt-2"},[r("span",{staticClass:"text-black"},[e._v(e._s(e.fileObject.name))]),e._v(" "),e.currentChunk!=e.chunks?r("div",{staticClass:"mt-2 text-gray-600"},[r("span",[e._v("文件校验中 "+e._s(e.fileMd5CheckProcess)+" ...")])]):e._e(),e._v(" "),e.fileMd5?r("div",{staticClass:"mt-2 text-gray-600"},[r("span",[e._v("\n        校验成功, 文件hash:"+e._s(e.fileMd5)+",\n        "),e.uploadStep<e.chunks?r("a",{staticClass:"text-blue-500 cursor-pointer",on:{click:e.uploadFileSlice}},[e._v("确认上传")]):r("span",[e._v("上传成功")])])]):e._e(),e._v(" "),e.isUploading?r("div",{staticClass:"mt-2 text-gray-600"},[e._v("上传中, 完成 "+e._s(e.uploadStep)+" / "+e._s(e.chunks)+" ...")]):e._e(),e._v(" "),e.uploadError?r("div",{staticClass:"mt-2 text-red-600"},[e._v(e._s(e.uploadError))]):e._e()])],1)}),[],!1,null,null,null).exports},fetch:(l=Object(c.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.store,t.params;case 1:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)}),methods:{}},m=Object(v.a)(_,(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{},[t("h3",{staticClass:"text-3xl"},[this._v("欢迎使用")])])}],!1,null,null,null);t.default=m.exports}}]);